{"Details": {"Properties": {"Name": "x_turla_x_turlasnakeimplant.bin", "md5": "25ad1d40b05d9b6978d352b490e7b93f", "sha1": "d25fa21aea56e0685119912d983757facfa326ac", "sha256": "88bb3b2ab34dbaa33ea4c6a2624d97fc78193e43342db7910043b4f8a2244418", "ssdeep": "192:ZcMdjzlmeno/hERhFXmIoozoZSiLpeaencO+MX1gcT:OMdjzIWRhFWIoozo4iFGnhg", "size": "15.20KB", "bytes": "15565", "mime": "application/x-dosexec", "extension": "application/octet-stream", "Entropy": "4.413866951974789 (Minimum: 0.0, Maximum: 8.0)"}}, "Location": {"Original": "/analyzer/folders/malware/x_Turla_x_TurlaSnakeImplant.bin", "File": "/analyzer/folders/output/bf5085d1-5dc1-4f3f-8ba3-93acef010271_25ad1d40b05d9b6978d352b490e7b93f/temp", "html": "/analyzer/folders/output/bf5085d1-5dc1-4f3f-8ba3-93acef010271_25ad1d40b05d9b6978d352b490e7b93f/x_Turla_x_TurlaSnakeImplant.bin.html", "json": "/analyzer/folders/output/bf5085d1-5dc1-4f3f-8ba3-93acef010271_25ad1d40b05d9b6978d352b490e7b93f/x_Turla_x_TurlaSnakeImplant.bin.json", "Folder": "/analyzer/folders/output/bf5085d1-5dc1-4f3f-8ba3-93acef010271_25ad1d40b05d9b6978d352b490e7b93f/temp_unpacked"}, "Encoding": {"Details": {"charset": "binary", "ForceEncoding": "utf-8", "ByteOrderMark": "None"}}, "PE": {"General": {"PE Type": "dll", "Entrypoint": "7941", "Entrypoint Section": ".text", "Header checksum": "0x0", "Verify checksum": "0xcb3e", "Match checksum": "False", "Sig": "558bec538b5d08568b750c85", "imphash": "6772345dfdfef239defde216b3d731f0", "warning": ["Byte 0x00 makes up 53.8130% of the file's contents. This may indicate truncation / malformation.", "Error parsing section 2. SizeOfRawData is larger than file.", "Error parsing section 3. SizeOfRawData is larger than file.", "Error parsing section 3. PointerToRawData points beyond the end of the file.", "Corrupt header \"IMAGE_BASE_RELOCATION\" at file offset 16384. Exception: 'Data length less than expected header length.'"], "Timestamp": "2013-02-04 05:19:53"}, "Characteristics": {"High Entropy": "False", "aslr": "False", "Force Integrity": "False", "dep": "False", "seh": "False", "No Bind": "False", "cfg": "False", "No Isolation": "False", "App Container": "False", "wdm Driver": "False"}, "Sections": [{"Section": ".text", "Suspicious": "True, 6.052474685482515", "Size": "4096", "MD5": "dd962b251f69773500c2db38bad567aa", "Entropy": "6.052474685482515 (Minimum: 0.0, Maximum: 8.0)", "Description": "code section"}, {"Section": ".rdata", "Suspicious": "No", "Size": "4096", "MD5": "375db36570862f926ec92dcce0ca4e9f", "Entropy": "1.721321450444841 (Minimum: 0.0, Maximum: 8.0)", "Description": "read-only initialized data section (ms and borland)"}, {"Section": ".data", "Suspicious": "True, 6.88974470567223", "Size": "4096", "MD5": "e09c9c17203bae20ebc74899e47674f0", "Entropy": "6.88974470567223 (Minimum: 0.0, Maximum: 8.0)", "Description": "data section"}, {"Section": ".reloc", "Suspicious": "True, 0.0", "Size": "4096", "MD5": "d41d8cd98f00b204e9800998ecf8427e", "Entropy": "0.0 (Minimum: 0.0, Max: 8.0)", "Description": "relocations section"}], "Dlls": [{"Dll": "WS2_32.dll", "Description": "windows socket 2.0 32-bit dll"}, {"Dll": "msvcrt.dll", "Description": "windows nt crt dll"}, {"Dll": "KERNEL32.dll", "Description": "windows nt base api client dll"}], "Imported functions": [{"Dll": "WS2_32.dll", "Function": "ntohl", "Description": "the tohl function converts a u_long from tcp/ip network order to host byte order (which is little-endian on intel processors)."}, {"Dll": "WS2_32.dll", "Function": "htonl", "Description": "the tonl function converts a u_long from host to tcp/ip network byte order (which is big-endian)."}, {"Dll": "msvcrt.dll", "Function": "_beginthreadex", "Description": ""}, {"Dll": "msvcrt.dll", "Function": "_adjust_fdiv", "Description": ""}, {"Dll": "msvcrt.dll", "Function": "malloc", "Description": "allocate/free dynamic memory"}, {"Dll": "msvcrt.dll", "Function": "_vsnprintf", "Description": "formatted output conversion"}, {"Dll": "msvcrt.dll", "Function": "fopen", "Description": "stream open functions"}, {"Dll": "msvcrt.dll", "Function": "vfprintf", "Description": "formatted output conversion"}, {"Dll": "msvcrt.dll", "Function": "fclose", "Description": "close stream"}, {"Dll": "msvcrt.dll", "Function": "free", "Description": "amount of free/used memory in system"}, {"Dll": "msvcrt.dll", "Function": "memcpy", "Description": "copy memory area"}, {"Dll": "msvcrt.dll", "Function": "_initterm", "Description": ""}, {"Dll": "KERNEL32.dll", "Function": "GetProcAddress", "Description": "retrieves the address of an exported function or variable from the specified dynamic-link library (dll)."}, {"Dll": "KERNEL32.dll", "Function": "SetErrorMode", "Description": "controls whether the system will handle the specified types of serious errors or whether the process will handle them."}, {"Dll": "KERNEL32.dll", "Function": "DisableThreadLibraryCalls", "Description": "disables the dll_thread_attach and dll_thread_detach notifications for the specified dynamic-link library (dll). this can reduce the size of the working set for some applications."}, {"Dll": "KERNEL32.dll", "Function": "Sleep", "Description": "suspends the execution of the current thread until the time-out interval elapses.to enter an alertable wait state, use thesleepex function."}, {"Dll": "KERNEL32.dll", "Function": "GetExitCodeThread", "Description": "retrieves the termination status of the specified thread."}, {"Dll": "KERNEL32.dll", "Function": "WaitForSingleObject", "Description": "waits until the specified object is in the signaled state or the time-out interval elapses.to enter an alertable wait state, use thewaitforsingleobjectex function. to wait for multiple objects, use thewaitformultipleobjects."}, {"Dll": "KERNEL32.dll", "Function": "SetEvent", "Description": "sets the specified event object to the signaled state."}, {"Dll": "KERNEL32.dll", "Function": "CloseHandle", "Description": "closes an open object handle."}, {"Dll": "KERNEL32.dll", "Function": "CreateEventA", "Description": "creates or opens a named or unnamed event object.to specify an access mask for the object, use the createeventex function."}, {"Dll": "KERNEL32.dll", "Function": "GetLastError", "Description": "retrieves the calling thread's last-error code value. the last-error code is maintained on a per-thread basis. multiple threads do not overwrite each other's last-error code.visual basic:applications should call err.lastdllerror instead ofgetlasterror."}], "Exported functions": [{"Function": "ModuleCommand", "Description": ""}, {"Function": "ModuleStart", "Description": ""}, {"Function": "ModuleStop", "Description": ""}]}, "Behavior": {"Intell": [{"Matched": "1", "Required": "1", "Behavior": "Dynamic loading", "Detected": "getprocaddress"}]}, "Language": {"English": [{"Count": "Unavailable", "Word": "free"}, {"Count": "Unavailable", "Word": "sleep"}], "UnKnown": [{"Count": "Unavailable", "Word": "ph`!"}, {"Count": "Unavailable", "Word": "d$ u"}, {"Count": "Unavailable", "Word": "snake_modules_command"}, {"Count": "Unavailable", "Word": "|$(sv"}, {"Count": "Unavailable", "Word": "u7wps"}, {"Count": "Unavailable", "Word": "getlasterror"}, {"Count": "Unavailable", "Word": "t$4rw"}, {"Count": "Unavailable", "Word": "seterrormode"}, {"Count": "Unavailable", "Word": "getexitcodethread"}, {"Count": "Unavailable", "Word": "snake_free"}, {"Count": "Unavailable", "Word": "d$%p"}, {"Count": "Unavailable", "Word": "8+p&"}, {"Count": "Unavailable", "Word": "jrhp:"}, {"Count": "Unavailable", "Word": "vfprintf"}, {"Count": "Unavailable", "Word": "tc_get_reply"}, {"Count": "Unavailable", "Word": "^[_]"}, {"Count": "Unavailable", "Word": "tr_write_pipe"}, {"Count": "Unavailable", "Word": "modulestart"}, {"Count": "Unavailable", "Word": "closehandle"}, {"Count": "Unavailable", "Word": "(vwj"}, {"Count": "Unavailable", "Word": "nwvs"}, {"Count": "Unavailable", "Word": "_adjust_fdiv"}, {"Count": "Unavailable", "Word": ".text"}, {"Count": "Unavailable", "Word": "fclose"}, {"Count": "Unavailable", "Word": "phh "}, {"Count": "Unavailable", "Word": "d$ 0"}, {"Count": "Unavailable", "Word": "msvcrt.dll"}, {"Count": "Unavailable", "Word": "`htwd"}, {"Count": "Unavailable", "Word": "getprocaddress"}, {"Count": "Unavailable", "Word": "_^][y"}, {"Count": "Unavailable", "Word": "modulestop"}, {"Count": "Unavailable", "Word": "pht!"}, {"Count": "Unavailable", "Word": "):d -"}, {"Count": "Unavailable", "Word": "f|@f"}, {"Count": "Unavailable", "Word": "phl!"}, {"Count": "Unavailable", "Word": "config_read_uint32"}, {"Count": "Unavailable", "Word": "rkctl_win32.dll"}, {"Count": "Unavailable", "Word": "t?hd:"}, {"Count": "Unavailable", "Word": "j,b)"}, {"Count": "Unavailable", "Word": "~5jo"}, {"Count": "Unavailable", "Word": "_vsnprintf"}, {"Count": "Unavailable", "Word": "modulecommand"}, {"Count": "Unavailable", "Word": "l$(3"}, {"Count": "Unavailable", "Word": "tc_free_data"}, {"Count": "Unavailable", "Word": "`.rdata"}, {"Count": "Unavailable", "Word": "ph\\:"}, {"Count": "Unavailable", "Word": "t$$r"}, {"Count": "Unavailable", "Word": "rich5"}, {"Count": "Unavailable", "Word": "tr_alloc"}, {"Count": "Unavailable", "Word": "!this program cannot be run in dos mode."}, {"Count": "Unavailable", "Word": "\\\\.\\pipe\\%s"}, {"Count": "Unavailable", "Word": "_beginthreadex"}, {"Count": "Unavailable", "Word": "snake_alloc"}, {"Count": "Unavailable", "Word": "tc_send_request"}, {"Count": "Unavailable", "Word": "t$ rpq"}, {"Count": "Unavailable", "Word": "d$ p"}, {"Count": "Unavailable", "Word": "@.data"}, {"Count": "Unavailable", "Word": "l$(q"}, {"Count": "Unavailable", "Word": "tc_read_request_pipe"}, {"Count": "Unavailable", "Word": "_^[]"}, {"Count": "Unavailable", "Word": "tc_send_request_bufs"}, {"Count": "Unavailable", "Word": "m~ 5"}, {"Count": "Unavailable", "Word": "tr_free"}, {"Count": "Unavailable", "Word": "t_close"}, {"Count": "Unavailable", "Word": "fopen"}, {"Count": "Unavailable", "Word": "}@hp!"}, {"Count": "Unavailable", "Word": "malloc"}, {"Count": "Unavailable", "Word": "d$ 3"}, {"Count": "Unavailable", "Word": "disablethreadlibrarycalls"}, {"Count": "Unavailable", "Word": "pvqw"}, {"Count": "Unavailable", "Word": "u&wvs"}, {"Count": "Unavailable", "Word": "kernel32.dll"}, {"Count": "Unavailable", "Word": "waitforsingleobject"}, {"Count": "Unavailable", "Word": "createeventa"}, {"Count": "Unavailable", "Word": "t_setoptbin"}, {"Count": "Unavailable", "Word": "psvw"}, {"Count": "Unavailable", "Word": "0;_pi6"}, {"Count": "Unavailable", "Word": "phd "}, {"Count": "Unavailable", "Word": "ws2_32.dll"}, {"Count": "Unavailable", "Word": ".reloc"}, {"Count": "Unavailable", "Word": "tc_socket"}, {"Count": "Unavailable", "Word": "_^]["}, {"Count": "Unavailable", "Word": "memcpy"}, {"Count": "Unavailable", "Word": "setevent"}, {"Count": "Unavailable", "Word": "-cv&"}, {"Count": "Unavailable", "Word": "tc_cancel"}, {"Count": "Unavailable", "Word": "|por"}, {"Count": "Unavailable", "Word": "c`kyr"}, {"Count": "Unavailable", "Word": "phd:"}, {"Count": "Unavailable", "Word": "php:"}, {"Count": "Unavailable", "Word": "_initterm"}]}, "Patterns": {"HEX": [{"Count": "1", "HEX": "cadd", "Parsed": ""}, {"Count": "1", "HEX": "eade", "Parsed": ""}]}, "Suspicious": {"Strings": [{"Count": "1", "Detected": "getprocaddress"}]}, "QBDETECT": {"Detection": [{"Count": "1", "Offset": "Unavailable", "Rule": "API Alert", "Match": "closehandle", "Parsed": "None"}, {"Count": "1", "Offset": "Unavailable", "Rule": "API Alert", "Match": "getprocaddress", "Parsed": "None"}, {"Count": "2", "Offset": "Unavailable", "Rule": "API Alert", "Match": "send", "Parsed": "None"}, {"Count": "1", "Offset": "Unavailable", "Rule": "API Alert", "Match": "socket", "Parsed": "None"}, {"Count": "1", "Offset": "Unavailable", "Rule": "API Alert", "Match": "sleep", "Parsed": "None"}]}, "Yara": {"Matches": [{"Count": "0", "Offset": "0x230", "Rule": "Data_Section_Detecton_1", "Patteren": ".data", "Parsed": "None", "Condition": "uint16(0) == 0x5a4d and uint32be(uint32(0x3c)) == 0x50450000 and (for any of them : ( $ in (0..1024) ))"}, {"Count": "0", "Offset": "0x208", "Rule": "Read_only_initialized_Data_Section_MS_and_Borland__Detecton_1", "Patteren": ".rdata", "Parsed": "None", "Condition": "uint16(0) == 0x5a4d and uint32be(uint32(0x3c)) == 0x50450000 and (for any of them : ( $ in (0..1024) ))"}, {"Count": "0", "Offset": "0x258", "Rule": "Relocations_Section_Detecton_1", "Patteren": ".reloc", "Parsed": "None", "Condition": "uint16(0) == 0x5a4d and uint32be(uint32(0x3c)) == 0x50450000 and (for any of them : ( $ in (0..1024) ))"}, {"Count": "0", "Offset": "0x1e0", "Rule": "Code_Section_Detecton_2", "Patteren": ".text", "Parsed": "None", "Condition": "uint16(0) == 0x5a4d and uint32be(uint32(0x3c)) == 0x50450000 and (for any of them : ( $ in (0..1024) ))"}, {"Count": "0", "Offset": "0x23ea", "Rule": "Top1000Passwords", "Patteren": "Star", "Parsed": "None", "Condition": "any of them"}, {"Count": "3", "Offset": "0x209b 0x20f3 0x215a 0x224c", "Rule": "Top1000Passwords", "Patteren": "free", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x236c", "Rule": "Windows_NT_BASE_API_Client_DLL_Detection_1", "Patteren": "KERNEL32.dll", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x229a", "Rule": "Windows_NT_CRT_DLL_Detection_1", "Patteren": "msvcrt.dll", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x2234", "Rule": "Windows_Socket_2_0_32_Bit_DLL_Detection_1", "Patteren": "WS2_32.dll", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x0", "Rule": "Windows_DOS_executable_file_EXE", "Patteren": "MZ", "Parsed": "None", "Condition": "$1 at 0"}, {"Count": "2", "Offset": "0x1903 0x19c3 0x1aeb", "Rule": "VMWare_MAC_Address_CouldBeFP", "Patteren": "\u0000PV", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x2299", "Rule": "Path", "Patteren": "\u0000msvcrt.dll", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x4e", "Rule": "dUP_v2_x_Patcher_Detecton_1", "Patteren": "This program cannot be run in DOS mo", "Parsed": "None", "Condition": "$1"}, {"Count": "0", "Offset": "0x1e20", "Rule": "Microsoft_Visual_C_6_0_8_0_Detecton_Number_8", "Patteren": "D$\bL$\u0010\u000b\u020bL$\fu\tD$\u0004\u0010\u0000S\u060bD$\bd$\u0014\u0003\u060bD$\b\u0003[\u0010\u0000", "Parsed": "None", "Condition": "$1"}, {"Count": "0", "Offset": "0x1f05", "Rule": "Microsoft_Visual_C_7_0_DLL_Detecton_1", "Patteren": "US]\bVu\fW}\u0010u\t=:\u0000P\u0000&\u0001", "Parsed": "None", "Condition": "$1"}, {"Count": "0", "Offset": "0x1f05", "Rule": "Microsoft_Visual_C_v6_0_DLL_Detecton_1", "Patteren": "US]\bVu\f", "Parsed": "None", "Condition": "$1 at pe.entry_point"}, {"Count": "0", "Offset": "0x1f05", "Rule": "Microsoft_Visual_C_v7_0_DLL_Detecton_2", "Patteren": "US]\bVu\fW}\u0010", "Parsed": "None", "Condition": "$1 at pe.entry_point"}], "Tags": [{"fullrule": "packers_index:IsPE32", "namespace": "packers_index", "color": "brown_color", "rule": "IsPE32", "meta": ""}, {"fullrule": "packers_index:IsDLL", "namespace": "packers_index", "color": "brown_color", "rule": "IsDLL", "meta": ""}, {"fullrule": "packers_index:IsWindowsGUI", "namespace": "packers_index", "color": "brown_color", "rule": "IsWindowsGUI", "meta": ""}, {"fullrule": "packers_index:IsBeyondImageSize", "namespace": "packers_index", "color": "brown_color", "rule": "IsBeyondImageSize", "meta": "author: _pusher_\ndate: 2016-07\ndescription: Data Beyond ImageSize Check"}, {"fullrule": "packers_index:HasRichSignature", "namespace": "packers_index", "color": "brown_color", "rule": "HasRichSignature", "meta": "author: _pusher_\ndescription: Rich Signature Check\ndate: 2016-07"}, {"fullrule": "packers_index:Microsoft_Visual_Cpp_v50v60_MFC", "namespace": "packers_index", "color": "brown_color", "rule": "Microsoft_Visual_Cpp_v50v60_MFC", "meta": ""}, {"fullrule": "packers_index:Microsoft_Visual_Cpp_70_DLL", "namespace": "packers_index", "color": "brown_color", "rule": "Microsoft_Visual_Cpp_70_DLL", "meta": ""}, {"fullrule": "packers_index:Microsoft_Visual_Cpp_70_DLL_additional", "namespace": "packers_index", "color": "brown_color", "rule": "Microsoft_Visual_Cpp_70_DLL_additional", "meta": ""}, {"fullrule": "packers_index:Microsoft_Visual_Cpp_v60_DLL", "namespace": "packers_index", "color": "brown_color", "rule": "Microsoft_Visual_Cpp_v60_DLL", "meta": ""}, {"fullrule": "packers_index:Microsoft_Visual_Cpp_70_DLL_Method_3", "namespace": "packers_index", "color": "brown_color", "rule": "Microsoft_Visual_Cpp_70_DLL_Method_3", "meta": ""}, {"fullrule": "capabilities_index:network_tcp_socket", "namespace": "capabilities_index", "color": "green_color", "rule": "network_tcp_socket", "meta": "author: x0r\ndescription: Communications over RAW socket\nversion: 0.1"}, {"fullrule": "capabilities_index:Str_Win32_Winsock2_Library", "namespace": "capabilities_index", "color": "green_color", "rule": "Str_Win32_Winsock2_Library", "meta": "author: @adricnet\ndescription: Match Winsock 2 API library declaration\nmethod: String match\nreference: https://github.com/dfirnotes/rules"}]}}