{"Details": {"Properties": {"Name": "x_doquapt_x_doqudropper.bin", "md5": "e8eaec1f021a564b82b824af1dbe6c4d", "sha1": "2422835716066b6bcecb045ddd4f1fbc9486667a", "sha256": "8e97c371633d285cd8fc842f4582705052a9409149ee67d97de545030787a192", "ssdeep": "192:Ty0m/YkX4KczWxF6Kj3IZ4ZItSfj4nHe/u2hO/tv/MFR3bddlqnLNuyKgAYmcDu8:+0mDLczWxF7yvHo2p8diZuygFmu8", "size": "17.50KB", "bytes": "17920", "mime": "application/x-dosexec", "extension": "application/octet-stream", "Entropy": "5.320243010024306 (Minimum: 0.0, Maximum: 8.0)"}}, "Location": {"Original": "/analyzer/folders/malware/x_DoquAPT_x_DoquDropper.bin", "File": "/analyzer/folders/output/9dd577d7-c867-4cf4-8840-3e592682f54e_e8eaec1f021a564b82b824af1dbe6c4d/temp", "html": "/analyzer/folders/output/9dd577d7-c867-4cf4-8840-3e592682f54e_e8eaec1f021a564b82b824af1dbe6c4d/x_DoquAPT_x_DoquDropper.bin.html", "json": "/analyzer/folders/output/9dd577d7-c867-4cf4-8840-3e592682f54e_e8eaec1f021a564b82b824af1dbe6c4d/x_DoquAPT_x_DoquDropper.bin.json", "Folder": "/analyzer/folders/output/9dd577d7-c867-4cf4-8840-3e592682f54e_e8eaec1f021a564b82b824af1dbe6c4d/temp_unpacked"}, "Encoding": {"Details": {"charset": "binary", "ForceEncoding": "utf-8", "ByteOrderMark": "None"}}, "PE": {"General": {"PE Type": "dll", "Entrypoint": "5096", "Entrypoint Section": ".text", "Header checksum": "0x0", "Verify checksum": "0xe72a", "Match checksum": "False", "Sig": "44894424188954241048894c", "imphash": "412ce10c97ba68ac129b9ab95c89d28a", "warning": "None", "Timestamp": "2004-02-11 18:04:50"}, "Characteristics": {"High Entropy": "True", "aslr": "True", "Force Integrity": "False", "dep": "True", "seh": "True", "No Bind": "False", "cfg": "False", "No Isolation": "False", "App Container": "False", "wdm Driver": "False"}, "Sections": [{"Section": ".text", "Suspicious": "No", "Size": "12288", "MD5": "0872642e1f84d32dc19f53417801f989", "Entropy": "5.353111975091697 (Minimum: 0.0, Maximum: 8.0)", "Description": "code section"}, {"Section": ".rdata", "Suspicious": "No", "Size": "2560", "MD5": "d38dab9b0d665dc5687f077e5c06145a", "Entropy": "5.847972913666121 (Minimum: 0.0, Maximum: 8.0)", "Description": "read-only initialized data section (ms and borland)"}, {"Section": ".data", "Suspicious": "True, 0.0", "Size": "0", "MD5": "d41d8cd98f00b204e9800998ecf8427e", "Entropy": "0.0 (Minimum: 0.0, Max: 8.0)", "Description": "data section"}, {"Section": ".pdata", "Suspicious": "No", "Size": "512", "MD5": "9873adcc4cc780de0708a1afb438358c", "Entropy": "1.0643367432826127 (Minimum: 0.0, Maximum: 8.0)", "Description": "exception handling functions section (pdata records)"}, {"Section": ".rsrc", "Suspicious": "No", "Size": "1536", "MD5": "adb7129aeb60f41d8fcb6a51c195ce90", "Entropy": "2.481002905363128 (Minimum: 0.0, Maximum: 8.0)", "Description": "resource section"}], "Dlls": [{"Dll": "msi.dll", "Description": "windows installer"}, {"Dll": "KERNEL32.dll", "Description": "windows nt base api client dll"}, {"Dll": "USER32.dll", "Description": "multi-user windows user api client dll"}, {"Dll": "ADVAPI32.dll", "Description": "advanced windows 32 base api"}], "Resources": [{"Resource": "RT_VERSION", "Offset": "0x7060", "MD5": "66a055ef995dd1aef30df4888d03de10", "Sig": "cc0334000000560053005f00", "Description": "version resource"}], "Imported functions": "None", "Exported functions": [{"Function": "StartAction", "Description": ""}]}, "Behavior": {"Intell": [{"Matched": "1", "Required": "1", "Behavior": "Registry interaction", "Detected": "regqueryvalue"}, {"Matched": "2", "Required": "2", "Behavior": "Packer functionality", "Detected": "virtualalloc,virtualprotect"}]}, "XREFS": {"TEXT": [{"From": "sub.msi.dll_MsiViewModify_ecc", "To": "sym.imp.msi.dll_MsiViewModify"}, {"From": "sub.msi.dll_MsiViewModify_ecc", "To": "sym.imp.msi.dll_MsiViewModify"}, {"From": "sub.msi.dll_MsiGetFeatureCostA_eea", "To": "sym.imp.msi.dll_MsiGetFeatureCostA"}, {"From": "sub.msi.dll_MsiGetFeatureCostA_eea", "To": "sym.imp.msi.dll_MsiGetFeatureCostA"}, {"From": "sub.msi.dll_MsiRecordSetStringA_ee4", "To": "sym.imp.msi.dll_MsiRecordSetStringA"}, {"From": "sub.msi.dll_MsiRecordSetStringA_ee4", "To": "sym.imp.msi.dll_MsiRecordSetStringA"}, {"From": "sub.msi.dll_MsiRecordGetStringW_ede", "To": "sym.imp.msi.dll_MsiRecordGetStringW"}, {"From": "sub.msi.dll_MsiRecordGetStringW_ede", "To": "sym.imp.msi.dll_MsiRecordGetStringW"}, {"From": "sub.msi.dll_MsiDatabaseMergeW_ed8", "To": "sym.imp.msi.dll_MsiDatabaseMergeW"}, {"From": "sub.msi.dll_MsiDatabaseMergeW_ed8", "To": "sym.imp.msi.dll_MsiDatabaseMergeW"}, {"From": "sub.msi.dll_MsiDatabaseIsTablePersistentA_ed2", "To": "sym.imp.msi.dll_MsiDatabaseIsTablePersistentA"}, {"From": "sub.msi.dll_MsiDatabaseIsTablePersistentA_ed2", "To": "sym.imp.msi.dll_MsiDatabaseIsTablePersistentA"}, {"From": "sub.msi.dll_MsiEnumClientsA_ec6", "To": "sym.imp.msi.dll_MsiEnumClientsA"}, {"From": "sub.msi.dll_MsiEnumClientsA_ec6", "To": "sym.imp.msi.dll_MsiEnumClientsA"}, {"From": "sub.msi.dll_MsiGetSummaryInformationW_ef0", "To": "sym.imp.msi.dll_MsiGetSummaryInformationW"}, {"From": "sub.msi.dll_MsiGetSummaryInformationW_ef0", "To": "sym.imp.msi.dll_MsiGetSummaryInformationW"}, {"From": "sub.msi.dll_MsiConfigureFeatureFromDescriptorA_ec0", "To": "sym.imp.msi.dll_MsiConfigureFeatureFromDescriptorA"}, {"From": "sub.msi.dll_MsiConfigureFeatureFromDescriptorA_ec0", "To": "sym.imp.msi.dll_MsiConfigureFeatureFromDescriptorA"}, {"From": "sub.A_cd0", "To": "sym.imp.KERNEL32.dll_VirtualFree"}, {"From": "sub.A_cd0", "To": "sym.imp.KERNEL32.dll_VirtualFree"}, {"From": "sub.A_cd0", "To": "sym.imp.KERNEL32.dll_VirtualProtect"}, {"From": "sub.A_cd0", "To": "sym.imp.KERNEL32.dll_VirtualProtect"}, {"From": "sub.A_cd0", "To": "sym.imp.KERNEL32.dll_VirtualAlloc"}, {"From": "sub.A_cd0", "To": "sym.imp.KERNEL32.dll_VirtualAlloc"}, {"From": "sub.A_cd0", "To": "sym.imp.USER32.dll_wsprintfW"}, {"From": "sub.A_cd0", "To": "sym.imp.USER32.dll_wsprintfW"}, {"From": "sym.MSI.dll_StartAction", "To": "sym.imp.ADVAPI32.dll_RegQueryValueExW"}, {"From": "sym.MSI.dll_StartAction", "To": "sym.imp.ADVAPI32.dll_RegQueryValueExW"}]}, "Language": {"UnKnown": [{"Count": "Unavailable", "Word": "t$ph"}, {"Count": "Unavailable", "Word": "t$0h"}, {"Count": "Unavailable", "Word": "kl$("}, {"Count": "Unavailable", "Word": "j]8rich"}, {"Count": "Unavailable", "Word": "d$ 3"}, {"Count": "Unavailable", "Word": "d$@l"}, {"Count": "Unavailable", "Word": "(uhp"}, {"Count": "Unavailable", "Word": "l$(l"}, {"Count": "Unavailable", "Word": "sfhcd$(hk"}, {"Count": "Unavailable", "Word": "wsprintfw"}, {"Count": "Unavailable", "Word": "!this program cannot be run in dos mode."}, {"Count": "Unavailable", "Word": ".text"}, {"Count": "Unavailable", "Word": "l$xl"}, {"Count": "Unavailable", "Word": "hcl$ h"}, {"Count": "Unavailable", "Word": "l$ h"}, {"Count": "Unavailable", "Word": "|$03"}, {"Count": "Unavailable", "Word": "d$xh"}, {"Count": "Unavailable", "Word": "l$8a"}, {"Count": "Unavailable", "Word": "`.rdata"}, {"Count": "Unavailable", "Word": "advapi32.dll"}, {"Count": "Unavailable", "Word": "fffffff"}, {"Count": "Unavailable", "Word": "srhcd$(hk"}, {"Count": "Unavailable", "Word": "@.data"}, {"Count": "Unavailable", "Word": "l$8e3"}, {"Count": "Unavailable", "Word": "d$(a"}, {"Count": "Unavailable", "Word": "d$ph"}, {"Count": "Unavailable", "Word": "l$$l"}, {"Count": "Unavailable", "Word": "hcd$ hcl$ h"}, {"Count": "Unavailable", "Word": "# !\""}, {"Count": "Unavailable", "Word": "kernel32.dll"}, {"Count": "Unavailable", "Word": "6i*h<8"}, {"Count": "Unavailable", "Word": "ffff"}, {"Count": "Unavailable", "Word": "d$(d"}, {"Count": "Unavailable", "Word": "}-hcd$ h"}, {"Count": "Unavailable", "Word": "t$(h"}, {"Count": "Unavailable", "Word": "user32.dll"}, {"Count": "Unavailable", "Word": "tt0~"}, {"Count": "Unavailable", "Word": "l$0h"}, {"Count": "Unavailable", "Word": "d$ h"}, {"Count": "Unavailable", "Word": "h9d$ s#h"}, {"Count": "Unavailable", "Word": "hkt$ "}, {"Count": "Unavailable", "Word": "d$,h"}, {"Count": "Unavailable", "Word": "l$ l"}, {"Count": "Unavailable", "Word": "9d$0so"}, {"Count": "Unavailable", "Word": "hkl$ "}, {"Count": "Unavailable", "Word": "d$$h"}, {"Count": "Unavailable", "Word": "t$ l"}, {"Count": "Unavailable", "Word": "regqueryvalueexw"}, {"Count": "Unavailable", "Word": "t$ h"}, {"Count": "Unavailable", "Word": "l$pa"}, {"Count": "Unavailable", "Word": "|$0 s"}, {"Count": "Unavailable", "Word": "6\"8d"}, {"Count": "Unavailable", "Word": "d$8h"}, {"Count": "Unavailable", "Word": "d$(h"}, {"Count": "Unavailable", "Word": "d$8l"}, {"Count": "Unavailable", "Word": "d$0h"}, {"Count": "Unavailable", "Word": "hcd$ h"}, {"Count": "Unavailable", "Word": "abc@"}, {"Count": "Unavailable", "Word": "+()*"}, {"Count": "Unavailable", "Word": "t$xh"}, {"Count": "Unavailable", "Word": "hcd$(hk"}, {"Count": "Unavailable", "Word": "qvlm"}, {"Count": "Unavailable", "Word": ".pdata"}, {"Count": "Unavailable", "Word": "d$`h"}, {"Count": "Unavailable", "Word": "d$@h"}, {"Count": "Unavailable", "Word": "}*hcd$ "}, {"Count": "Unavailable", "Word": "startaction"}, {"Count": "Unavailable", "Word": "t=hcd$(hk"}, {"Count": "Unavailable", "Word": "msi.dll"}, {"Count": "Unavailable", "Word": "@.rsrc"}, {"Count": "Unavailable", "Word": "&'$%"}, {"Count": "Unavailable", "Word": ":;89"}, {"Count": "Unavailable", "Word": "virtualfree"}, {"Count": "Unavailable", "Word": "@op,"}, {"Count": "Unavailable", "Word": "t@hcd$(hk"}, {"Count": "Unavailable", "Word": "'$%&"}, {"Count": "Unavailable", "Word": "virtualprotect"}, {"Count": "Unavailable", "Word": "l$@l"}, {"Count": "Unavailable", "Word": "virtualalloc"}, {"Count": "Unavailable", "Word": "=>?<"}]}, "Patterns": {"HEX": [{"Count": "2", "HEX": "ffff", "Parsed": ""}]}, "Creds": {"Logins": [{"Count": "1", "UserPass": "user32.dll\n"}]}, "QBDETECT": {"Detection": [{"Count": "1", "Offset": "Unavailable", "Rule": "API Alert", "Match": "virtualfree", "Parsed": "None"}, {"Count": "1", "Offset": "Unavailable", "Rule": "API Alert", "Match": "virtualalloc", "Parsed": "None"}, {"Count": "1", "Offset": "Unavailable", "Rule": "API Alert", "Match": "virtualprotect", "Parsed": "None"}]}, "Yara": {"Matches": [{"Count": "0", "Offset": "0x238", "Rule": "Data_Section_Detecton_1", "Patteren": ".data", "Parsed": "None", "Condition": "uint16(0) == 0x5a4d and uint32be(uint32(0x3c)) == 0x50450000 and (for any of them : ( $ in (0..1024) ))"}, {"Count": "0", "Offset": "0x260", "Rule": "Exception_Handling_Functions_Section_PDATA_records__Detecton_1", "Patteren": ".pdata", "Parsed": "None", "Condition": "uint16(0) == 0x5a4d and uint32be(uint32(0x3c)) == 0x50450000 and (for any of them : ( $ in (0..1024) ))"}, {"Count": "0", "Offset": "0x210", "Rule": "Read_only_initialized_Data_Section_MS_and_Borland__Detecton_1", "Patteren": ".rdata", "Parsed": "None", "Condition": "uint16(0) == 0x5a4d and uint32be(uint32(0x3c)) == 0x50450000 and (for any of them : ( $ in (0..1024) ))"}, {"Count": "0", "Offset": "0x288", "Rule": "Resource_section_Detecton_1", "Patteren": ".rsrc", "Parsed": "None", "Condition": "uint16(0) == 0x5a4d and uint32be(uint32(0x3c)) == 0x50450000 and (for any of them : ( $ in (0..1024) ))"}, {"Count": "0", "Offset": "0x1e8", "Rule": "Code_Section_Detecton_2", "Patteren": ".text", "Parsed": "None", "Condition": "uint16(0) == 0x5a4d and uint32be(uint32(0x3c)) == 0x50450000 and (for any of them : ( $ in (0..1024) ))"}, {"Count": "1", "Offset": "0x41b2 0x43a4", "Rule": "Top1000Passwords", "Patteren": "E\u0000x\u0000p\u0000l\u0000o\u0000r\u0000e\u0000r\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x3aca", "Rule": "Top1000Passwords", "Patteren": "Star", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x39a8", "Rule": "Top1000Passwords", "Patteren": "A\u0000c\u0000t\u0000i\u0000o\u0000n\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x3acf", "Rule": "Top1000Passwords", "Patteren": "Action", "Parsed": "None", "Condition": "any of them"}, {"Count": "1", "Offset": "0x4290 0x430c", "Rule": "Top1000Passwords", "Patteren": "M\u0000a\u0000r\u0000k\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x42ce", "Rule": "Top1000Passwords", "Patteren": "m\u0000a\u0000r\u0000k\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x3bf1", "Rule": "Top1000Passwords", "Patteren": "Free", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x3c42", "Rule": "Advanced_Windows_32_Base_API_Detection_1", "Patteren": "ADVAPI32.dll", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x3c45", "Rule": "EDIABAS_Server_Interface_for_Win32_Detection_1", "Patteren": "API32.dll", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x3c08", "Rule": "Windows_NT_BASE_API_Client_DLL_Detection_1", "Patteren": "KERNEL32.dll", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x3ac2", "Rule": "Windows_Installer_Detection_1", "Patteren": "MSI.dll", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x3bd0", "Rule": "Windows_Installer_Detection_1", "Patteren": "msi.dll", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x3c22", "Rule": "Multi_User_Windows_USER_API_Client_DLL_Detection_1", "Patteren": "USER32.dll", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x0", "Rule": "Windows_DOS_executable_file_EXE", "Patteren": "MZ", "Parsed": "None", "Condition": "$1 at 0"}, {"Count": "0", "Offset": "0x3bcf", "Rule": "Path", "Patteren": "\u0000msi.dll", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x4e", "Rule": "dUP_v2_x_Patcher_Detecton_1", "Patteren": "This program cannot be run in DOS mo", "Parsed": "None", "Condition": "$1"}], "Tags": [{"fullrule": "packers_index:IsPE64", "namespace": "packers_index", "color": "brown_color", "rule": "IsPE64", "meta": ""}, {"fullrule": "packers_index:IsDLL", "namespace": "packers_index", "color": "brown_color", "rule": "IsDLL", "meta": ""}, {"fullrule": "packers_index:IsWindowsGUI", "namespace": "packers_index", "color": "brown_color", "rule": "IsWindowsGUI", "meta": ""}, {"fullrule": "packers_index:HasRichSignature", "namespace": "packers_index", "color": "brown_color", "rule": "HasRichSignature", "meta": "author: _pusher_\ndescription: Rich Signature Check\ndate: 2016-07"}, {"fullrule": "malware_index:apt_duqu2_loaders", "namespace": "malware_index", "color": "red_color", "rule": "apt_duqu2_loaders", "meta": "copyright: Kaspersky Lab\ndescription: Rule to detect Duqu 2.0 samples\nlast_modified: 2015-06-09\nversion: 1.0"}, {"fullrule": "malware_index:APT_Kaspersky_Duqu2_procexp", "namespace": "malware_index", "color": "red_color", "rule": "APT_Kaspersky_Duqu2_procexp", "meta": "description: Kaspersky APT Report - Duqu2 Sample - Malicious MSI\nauthor: Florian Roth\nreference: https://goo.gl/7yKyOj\ndate: 2015-06-10\nhash1: 2422835716066b6bcecb045ddd4f1fbc9486667a\nhash2: b120620b5d82b05fee2c2153ceaf305807fa9f79\nhash3: 288ebfe21a71f83b5575dfcc92242579fb13910d"}]}}