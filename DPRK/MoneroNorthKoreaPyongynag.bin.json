{"Details": {"Properties": {"Name": "x_dprk_x_moneronorthkoreapyongynag.bin", "md5": "6a261443299788af1467142d5f538b2c", "sha1": "8965381377a884aa68eeb451b3e62175968b0b04", "sha256": "c599f3ca3417169e4a620b8231f8a97ccc63e291b9e09c888e6807dd90f1f17c", "ssdeep": "192:RB2vvWH4YUS1AeeRllgZNNby2WqxIW1PnaWn/3DOeR7c7OONAHHvzM:6ekZqlbdWqbnaW7BcTNm", "size": "11.00KB", "bytes": "11264", "mime": "application/x-dosexec", "extension": "application/octet-stream", "Entropy": "5.049538788275653 (Minimum: 0.0, Maximum: 8.0)"}}, "Location": {"Original": "/analyzer/folders/malware/x_DPRK_x_MoneroNorthKoreaPyongynag.bin", "File": "/analyzer/folders/output/5cf0009c-d0d5-4417-89aa-320dff30072c_6a261443299788af1467142d5f538b2c/temp", "html": "/analyzer/folders/output/5cf0009c-d0d5-4417-89aa-320dff30072c_6a261443299788af1467142d5f538b2c/x_DPRK_x_MoneroNorthKoreaPyongynag.bin.html", "json": "/analyzer/folders/output/5cf0009c-d0d5-4417-89aa-320dff30072c_6a261443299788af1467142d5f538b2c/x_DPRK_x_MoneroNorthKoreaPyongynag.bin.json", "Folder": "/analyzer/folders/output/5cf0009c-d0d5-4417-89aa-320dff30072c_6a261443299788af1467142d5f538b2c/temp_unpacked"}, "Encoding": {"Details": {"charset": "binary", "ForceEncoding": "utf-8", "ByteOrderMark": "None"}}, "PE": {"General": {"PE Type": "exe", "Entrypoint": "16686", "Entrypoint Section": ".text", "Header checksum": "0x0", "Verify checksum": "0x6bf0", "Match checksum": "False", "Sig": "ff2500204000000000000000", "imphash": "f34d5f2d4577ed6d9ceec516c1f5a744", "warning": "None", "Timestamp": "2017-12-24 12:18:34"}, "Characteristics": {"High Entropy": "False", "aslr": "True", "Force Integrity": "False", "dep": "True", "seh": "False", "No Bind": "False", "cfg": "False", "No Isolation": "False", "App Container": "False", "wdm Driver": "False"}, "Sections": [{"Section": ".text", "Suspicious": "No", "Size": "8704", "MD5": "e230b4f456e58a5952466e4ab85dd5e0", "Entropy": "5.424269447816209 (Minimum: 0.0, Maximum: 8.0)", "Description": "code section"}, {"Section": ".rsrc", "Suspicious": "No", "Size": "1536", "MD5": "0e46318c79bbb6caed63db0a50e4894e", "Entropy": "4.108790336127428 (Minimum: 0.0, Maximum: 8.0)", "Description": "resource section"}, {"Section": ".reloc", "Suspicious": "True, 0.08153941234324169", "Size": "512", "MD5": "382956180b01ebd48ffc72b5fb975502", "Entropy": "0.08153941234324169 (Minimum: 0.0, Maximum: 8.0)", "Description": "relocations section"}], "Dlls": [{"Dll": "mscoree.dll", "Description": "microsoft .net runtime execution engine"}], "Resources": [{"Resource": "RT_VERSION", "Offset": "0x6090", "MD5": "3aed61c4aa9654243ec70176953e1f78", "Sig": "2c0334000000560053005f00", "Description": "version resource"}, {"Resource": "RT_MANIFEST", "Offset": "0x63cc", "MD5": "b7db84991f23a680df8e95af8946f9c9", "Sig": "efbbbf3c3f786d6c20766572", "Description": "side-by-side assembly manifest"}], "Imported functions": [{"Dll": "mscoree.dll", "Function": "_CorExeMain", "Description": ""}], "Manifest": "\ufeff<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\r\n\r\n<assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\">\r\n  <assemblyIdentity version=\"1.0.0.0\" name=\"MyApplication.app\"/>\r\n  <trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v2\">\r\n    <security>\r\n      <requestedPrivileges xmlns=\"urn:schemas-microsoft-com:asm.v3\">\r\n        <requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\"/>\r\n      </requestedPrivileges>\r\n    </security>\r\n  </trustInfo>\r\n</assembly>"}, "Language": {"English": [{"Count": "Unavailable", "Word": "instance"}, {"Count": "Unavailable", "Word": "random"}, {"Count": "Unavailable", "Word": "console"}, {"Count": "Unavailable", "Word": "system"}, {"Count": "Unavailable", "Word": "activator"}, {"Count": "Unavailable", "Word": "interaction"}, {"Count": "Unavailable", "Word": "environment"}, {"Count": "Unavailable", "Word": "empty"}, {"Count": "Unavailable", "Word": "process"}, {"Count": "Unavailable", "Word": "copy"}, {"Count": "Unavailable", "Word": "next"}, {"Count": "Unavailable", "Word": "file"}, {"Count": "Unavailable", "Word": "synchronized"}, {"Count": "Unavailable", "Word": "main"}, {"Count": "Unavailable", "Word": "value"}, {"Count": "Unavailable", "Word": "start"}], "UnKnown": [{"Count": "Unavailable", "Word": "system.globalization"}, {"Count": "Unavailable", "Word": "system.codedom.compiler"}, {"Count": "Unavailable", "Word": "system.runtime.versioning"}, {"Count": "Unavailable", "Word": "comvisibleattribute"}, {"Count": "Unavailable", "Word": "microsoft.visualbasic.compilerservices"}, {"Count": "Unavailable", "Word": "concatenateobject"}, {"Count": "Unavailable", "Word": "get_resourcemanager"}, {"Count": "Unavailable", "Word": "runtimehelpers"}, {"Count": "Unavailable", "Word": "mywebservices"}, {"Count": "Unavailable", "Word": "referenceequals"}, {"Count": "Unavailable", "Word": "tostring"}, {"Count": "Unavailable", "Word": "`.rsrc"}, {"Count": "Unavailable", "Word": "newlatebinding"}, {"Count": "Unavailable", "Word": "mscorlib"}, {"Count": "Unavailable", "Word": "cultureinfo"}, {"Count": "Unavailable", "Word": "get_default"}, {"Count": "Unavailable", "Word": "get_assembly"}, {"Count": "Unavailable", "Word": "system.runtime.interopservices"}, {"Count": "Unavailable", "Word": "assemblydescriptionattribute"}, {"Count": "Unavailable", "Word": "directoryinfo"}, {"Count": "Unavailable", "Word": "v4.0.30319"}, {"Count": "Unavailable", "Word": "system.componentmodel"}, {"Count": "Unavailable", "Word": "wrapnonexceptionthrows"}, {"Count": "Unavailable", "Word": "assemblycompanyattribute"}, {"Count": "Unavailable", "Word": "assemblyproductattribute"}, {"Count": "Unavailable", "Word": "helpkeywordattribute"}, {"Count": "Unavailable", "Word": "exists"}, {"Count": "Unavailable", "Word": "kmicrosoft.visualstudio.editors.settingsdesigner.settingssinglefilegenerator"}, {"Count": "Unavailable", "Word": "get_application"}, {"Count": "Unavailable", "Word": "mysettings"}, {"Count": "Unavailable", "Word": "stathreadattribute"}, {"Count": "Unavailable", "Word": "assemblycopyrightattribute"}, {"Count": "Unavailable", "Word": "threadstaticattribute"}, {"Count": "Unavailable", "Word": "gethashcode"}, {"Count": "Unavailable", "Word": "dispose__instance__"}, {"Count": "Unavailable", "Word": "myapplication"}, {"Count": "Unavailable", "Word": "assemblyfileversionattribute"}, {"Count": "Unavailable", "Word": "consoleapp5.resources.resources"}, {"Count": "Unavailable", "Word": "set_arguments"}, {"Count": "Unavailable", "Word": "my.computer"}, {"Count": "Unavailable", "Word": "debuggerhiddenattribute"}, {"Count": "Unavailable", "Word": "writeline"}, {"Count": "Unavailable", "Word": "debuggableattribute"}, {"Count": "Unavailable", "Word": "get_processorcount"}, {"Count": "Unavailable", "Word": "      </requestedprivileges>"}, {"Count": "Unavailable", "Word": "get_getinstance"}, {"Count": "Unavailable", "Word": "mygroupcollectionattribute"}, {"Count": "Unavailable", "Word": "lsystem.resources.resourcereader, mscorlib, version=4.0.0.0, culture=neutral, publickeytoken=b77a5c561934e089#system.resources.runtimeresourceset"}, {"Count": "Unavailable", "Word": "<module>"}, {"Count": "Unavailable", "Word": "createobject"}, {"Count": "Unavailable", "Word": "padpadp"}, {"Count": "Unavailable", "Word": "runtimetypehandle"}, {"Count": "Unavailable", "Word": "1.0.0.0"}, {"Count": "Unavailable", "Word": ".text"}, {"Count": "Unavailable", "Word": "set_windowstyle"}, {"Count": "Unavailable", "Word": "  <trustinfo xmlns=\"urn:schemas-microsoft-com:asm.v2\">"}, {"Count": "Unavailable", "Word": "system.io"}, {"Count": "Unavailable", "Word": "myproject"}, {"Count": "Unavailable", "Word": ".netframework,version=v4.0"}, {"Count": "Unavailable", "Word": "int32"}, {"Count": "Unavailable", "Word": "system.diagnostics"}, {"Count": "Unavailable", "Word": ".ctor"}, {"Count": "Unavailable", "Word": "lateset"}, {"Count": "Unavailable", "Word": "mytemplate"}, {"Count": "Unavailable", "Word": "get_settings"}, {"Count": "Unavailable", "Word": "gettype"}, {"Count": "Unavailable", "Word": "consoleapplicationbase"}, {"Count": "Unavailable", "Word": "assemblytrademarkattribute"}, {"Count": "Unavailable", "Word": "system.reflection"}, {"Count": "Unavailable", "Word": "get_length"}, {"Count": "Unavailable", "Word": "#blob"}, {"Count": "Unavailable", "Word": "defaultinstance"}, {"Count": "Unavailable", "Word": "consoleapp5"}, {"Count": "Unavailable", "Word": "createinstance"}, {"Count": "Unavailable", "Word": ".cctor"}, {"Count": "Unavailable", "Word": "conversions"}, {"Count": "Unavailable", "Word": "module1"}, {"Count": "Unavailable", "Word": "guidattribute"}, {"Count": "Unavailable", "Word": "mycomputer"}, {"Count": "Unavailable", "Word": "*r~k"}, {"Count": "Unavailable", "Word": "m_userobjectprovider"}, {"Count": "Unavailable", "Word": "microsoft.visualbasic.devices"}, {"Count": "Unavailable", "Word": "$82e999fb-a6e0-4094-aa1f-1a306069d1a5"}, {"Count": "Unavailable", "Word": "m_mywebservicesobjectprovider"}, {"Count": "Unavailable", "Word": "system.resources"}, {"Count": "Unavailable", "Word": "assemblytitleattribute"}, {"Count": "Unavailable", "Word": "get_user"}, {"Count": "Unavailable", "Word": "_corexemain"}, {"Count": "Unavailable", "Word": "mysettingsproperty"}, {"Count": "Unavailable", "Word": "microsoft.visualbasic"}, {"Count": "Unavailable", "Word": "m_computerobjectprovider"}, {"Count": "Unavailable", "Word": "lateget"}, {"Count": "Unavailable", "Word": "3system.resources.tools.stronglytypedresourcebuilder"}, {"Count": "Unavailable", "Word": "#strings"}, {"Count": "Unavailable", "Word": "!this program cannot be run in dos mode."}, {"Count": "Unavailable", "Word": "      <requestedprivileges xmlns=\"urn:schemas-microsoft-com:asm.v3\">"}, {"Count": "Unavailable", "Word": "copyright "}, {"Count": "Unavailable", "Word": "frameworkdisplayname"}, {"Count": "Unavailable", "Word": "</assembly>"}, {"Count": "Unavailable", "Word": "4system.web.services.protocols.soaphttpclientprotocol"}, {"Count": "Unavailable", "Word": "resourceman"}, {"Count": "Unavailable", "Word": "processwindowstyle"}, {"Count": "Unavailable", "Word": "create__instance__"}, {"Count": "Unavailable", "Word": "tochararray"}, {"Count": "Unavailable", "Word": "@.reloc"}, {"Count": "Unavailable", "Word": "<assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestversion=\"1.0\">"}, {"Count": "Unavailable", "Word": "hidemodulenameattribute"}, {"Count": "Unavailable", "Word": "microsoft.visualbasic.applicationservices"}, {"Count": "Unavailable", "Word": "standardmoduleattribute"}, {"Count": "Unavailable", "Word": "#guid"}, {"Count": "Unavailable", "Word": "system.configuration"}, {"Count": "Unavailable", "Word": "my.settings"}, {"Count": "Unavailable", "Word": "getobjectvalue"}, {"Count": "Unavailable", "Word": "resourceculture"}, {"Count": "Unavailable", "Word": "my.user"}, {"Count": "Unavailable", "Word": "    <security>"}, {"Count": "Unavailable", "Word": "  2017"}, {"Count": "Unavailable", "Word": "latecall"}, {"Count": "Unavailable", "Word": "  </trustinfo>"}, {"Count": "Unavailable", "Word": "concat"}, {"Count": "Unavailable", "Word": "debuggernonusercodeattribute"}, {"Count": "Unavailable", "Word": "system.componentmodel.design"}, {"Count": "Unavailable", "Word": "editorbrowsableattribute"}, {"Count": "Unavailable", "Word": "debuggingmodes"}, {"Count": "Unavailable", "Word": "applicationsettingsbase"}, {"Count": "Unavailable", "Word": "processstartinfo"}, {"Count": "Unavailable", "Word": ".net framework 4"}, {"Count": "Unavailable", "Word": "editorbrowsablestate"}, {"Count": "Unavailable", "Word": "c:\\users\\jawhar\\documents\\visual studio 2017\\projects\\consoleapp5\\consoleapp5\\obj\\release\\consoleapp5.pdb"}, {"Count": "Unavailable", "Word": "operators"}, {"Count": "Unavailable", "Word": "generatedcodeattribute"}, {"Count": "Unavailable", "Word": "11.0.0.0"}, {"Count": "Unavailable", "Word": "targetframeworkattribute"}, {"Count": "Unavailable", "Word": "consoleapp5.my"}, {"Count": "Unavailable", "Word": "consoleapp5.exe"}, {"Count": "Unavailable", "Word": "compilationrelaxationsattribute"}, {"Count": "Unavailable", "Word": "my.application"}, {"Count": "Unavailable", "Word": "gettypefromhandle"}, {"Count": "Unavailable", "Word": "get_webservices"}, {"Count": "Unavailable", "Word": "m_threadstaticvalue"}, {"Count": "Unavailable", "Word": "  <assemblyidentity version=\"1.0.0.0\" name=\"myapplication.app\"/>"}, {"Count": "Unavailable", "Word": "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?>"}, {"Count": "Unavailable", "Word": "bsjb"}, {"Count": "Unavailable", "Word": "compilergeneratedattribute"}, {"Count": "Unavailable", "Word": "m_appobjectprovider"}, {"Count": "Unavailable", "Word": "4.0.0.0"}, {"Count": "Unavailable", "Word": "rsds-"}, {"Count": "Unavailable", "Word": "set_culture"}, {"Count": "Unavailable", "Word": "    </security>"}, {"Count": "Unavailable", "Word": "createdirectory"}, {"Count": "Unavailable", "Word": "system.runtime.compilerservices"}, {"Count": "Unavailable", "Word": "get_culture"}, {"Count": "Unavailable", "Word": "get_computer"}, {"Count": "Unavailable", "Word": "consoleapp5.my.resources"}, {"Count": "Unavailable", "Word": "my.webservices"}, {"Count": "Unavailable", "Word": "mscoree.dll"}, {"Count": "Unavailable", "Word": "runtimecompatibilityattribute"}, {"Count": "Unavailable", "Word": "threadsafeobjectprovider`1"}, {"Count": "Unavailable", "Word": "        <requestedexecutionlevel level=\"asinvoker\" uiaccess=\"false\"/>"}]}, "Patterns": {"IP4S": [{"Count": "2", "IP": "1.0.0.0", "Code": "36", "Alpha2": "au", "Description": "Australia"}, {"Count": "2", "IP": "11.0.0.0", "Code": "840", "Alpha2": "us", "Description": "United States"}, {"Count": "2", "IP": "4.0.0.0", "Code": "840", "Alpha2": "us", "Description": "United States"}], "LINKS": [{"Count": "1", "Link": "system.io", "Description": ""}, {"Count": "1", "Link": "system.componentmodel.design", "Description": ""}, {"Count": "1", "Link": "consoleapp5.my", "Description": ""}, {"Count": "1", "Link": "my.computer", "Description": ""}, {"Count": "1", "Link": "myapplication.app", "Description": ""}], "TAGS": [{"Count": "1", "TAG": "\n    "}, {"Count": "1", "TAG": "\n  "}, {"Count": "1", "TAG": "\n"}, {"Count": "1", "TAG": "\n      "}], "HEX": [{"Count": "1", "HEX": "acce", "Parsed": ""}, {"Count": "2", "HEX": "defa", "Parsed": ""}, {"Count": "1", "HEX": "eade", "Parsed": ""}, {"Count": "1", "HEX": "82e999fb", "Parsed": ""}, {"Count": "1", "HEX": "4094", "Parsed": "@"}, {"Count": "1", "HEX": "eada", "Parsed": ""}, {"Count": "1", "HEX": "1a306069d1a5", "Parsed": "\u001a0`i\u0465"}, {"Count": "1", "HEX": "aa1f", "Parsed": "\u001f"}, {"Count": "1", "HEX": "a6e0", "Parsed": ""}, {"Count": "2", "HEX": "2017", "Parsed": " \u0017"}, {"Count": "1", "HEX": "b77a5c561934e089", "Parsed": "z\\V\u00194"}]}, "Suspicious": {"Strings": [{"Count": "1", "Detected": "4system.web.services.protocols.soaphttpclientprotocol"}]}, "Encryption": {"UUIDs": [{"Count": "1", "Description": "UUID type 4", "UUID": "82e999fb-a6e0-4094-aa1f-1a306069d1a5"}]}, "Creds": {"Logins": [{"Count": "1", "UserPass": "users\\jawhar\\documents\\visual studio 2017\\projects\\consoleapp5\\consoleapp5\\obj\\release\\consoleapp5.pdb\n"}, {"Count": "1", "UserPass": "sign\n"}, {"Count": "2", "UserPass": "user\n"}, {"Count": "1", "UserPass": "usercodeattribute\n"}, {"Count": "1", "UserPass": "userobjectprovider\n"}, {"Count": "1", "UserPass": "signer.settingssinglefilegenerator\n"}]}, "QBDETECT": {"Detection": [{"Count": "1", "Offset": "Unavailable", "Rule": "API Alert", "Match": "createdirectory", "Parsed": "None"}, {"Count": "17", "Offset": "Unavailable", "Rule": "API Alert", "Match": "system", "Parsed": "None"}, {"Count": "1", "Offset": "Unavailable", "Rule": "API Alert", "Match": "bind", "Parsed": "None"}]}, "MITRE": {"Attack": [{"Id": "t1033", "Name": "System Owner/User Discovery", "Detected": "users", "Description": "### Windows\n\nAdversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using [Credential Dumping](https://attack.mitre.org/techniques/T1003). The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs.\n\n### Mac\n\nOn Mac, the currently logged in user can be identified with <code>users</code>,<code>w</code>, and <code>who</code>.\n\n### Linux\n\nOn Linux, the currently logged in user can be identified with <code>w</code> and <code>who</code>."}, {"Id": "t1142", "Name": "Keychain", "Detected": "security", "Description": "Keychains are the built-in way for macOS to keep track of users' passwords and credentials for many services and features such as WiFi passwords, websites, secure notes, certificates, and Kerberos. Keychain files are located in <code>~/Library/Keychains/</code>,<code>/Library/Keychains/</code>, and <code>/Network/Library/Keychains/</code>. (Citation: Wikipedia keychain) The <code>security</code> command-line utility, which is built into macOS by default, provides a useful way to manage these credentials.\n\nTo manage their credentials, users have to use additional credentials to access their keychain. If an adversary knows the credentials for the login keychain, then they can get access to all the other credentials stored in this vault. (Citation: External to DA, the OS X Way) By default, the passphrase for the keychain is the user\u2019s logon credentials."}, {"Id": "t1153", "Name": "Source", "Detected": "source", "Description": "The <code>source</code> command loads functions into the current shell or executes files in the current context. This built-in command can be run in two different ways <code>source /path/to/filename [arguments]</code> or <code>. /path/to/filename [arguments]</code>. Take note of the space after the \".\". Without a space, a new shell is created that runs the program instead of running the program within the current context. This is often used to make certain features or functions available to a shell or to update a specific shell's environment. \n\nAdversaries can abuse this functionality to execute programs. The file executed with this technique does not need to be marked executable beforehand."}, {"Id": "t1183", "Name": "Image File Execution Options Injection", "Detected": "debugger", "Description": "Image File Execution Options (IFEO) enable a developer to attach a debugger to an application. When a process is created, a debugger present in an application\u2019s IFEO will be prepended to the application\u2019s name, effectively launching the new process under the debugger (e.g., \u201cC:\\dbg\\ntsd.exe -g  notepad.exe\u201d). (Citation: Microsoft Dev Blog IFEO Mar 2010)\n\nIFEOs can be set directly via the Registry or in Global Flags via the GFlags tool. (Citation: Microsoft GFlags Mar 2017) IFEOs are represented as <code>Debugger</code> values in the Registry under <code>HKLM\\SOFTWARE{\\Wow6432Node}\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\<executable></code> where <code><executable></code> is the binary on which the debugger is attached. (Citation: Microsoft Dev Blog IFEO Mar 2010)\n\nIFEOs can also enable an arbitrary monitor program to be launched when a specified program silently exits (i.e. is prematurely terminated by itself or a second, non kernel-mode process). (Citation: Microsoft Silent Process Exit NOV 2017) (Citation: Oddvar Moe IFEO APR 2018) Similar to debuggers, silent exit monitoring can be enabled through GFlags and/or by directly modifying IEFO and silent process exit Registry values in <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\</code>. (Citation: Microsoft Silent Process Exit NOV 2017) (Citation: Oddvar Moe IFEO APR 2018)\n\nAn example where the evil.exe process is started when notepad.exe exits: (Citation: Oddvar Moe IFEO APR 2018)\n\n* <code>reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\notepad.exe\" /v GlobalFlag /t REG_DWORD /d 512</code>\n* <code>reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\notepad.exe\" /v ReportingMode /t REG_DWORD /d 1</code>\n* <code>reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\notepad.exe\" /v MonitorProcess /d \"C:\\temp\\evil.exe\"</code>\n\nSimilar to [Process Injection](https://attack.mitre.org/techniques/T1055), these values may be abused to obtain persistence and privilege escalation by causing a malicious executable to be loaded and run in the context of separate processes on the computer. (Citation: Endgame Process Injection July 2017) Installing IFEO mechanisms may also provide Persistence via continuous invocation.\n\nMalware may also use IFEO for Defense Evasion by registering invalid debuggers that redirect and effectively disable various system and security applications. (Citation: FSecure Hupigon) (Citation: Symantec Ushedix June 2008)"}, {"Id": "t1222", "Name": "File Permissions Modification", "Detected": "attrib", "Description": "File permissions are commonly managed by discretionary access control lists (DACLs) specified by the file owner. File DACL implementation may vary by platform, but generally explicitly designate which users/groups can perform which actions (ex: read, write, execute, etc.). (Citation: Microsoft DACL May 2018) (Citation: Microsoft File Rights May 2018) (Citation: Unix File Permissions)\n\nAdversaries may modify file permissions/attributes to evade intended DACLs. (Citation: Hybrid Analysis Icacls1 June 2018) (Citation: Hybrid Analysis Icacls2 May 2018) Modifications may include changing specific access rights, which may require taking ownership of a file and/or elevated permissions such as Administrator/root depending on the file's existing permissions to enable malicious activity such as modifying, replacing, or deleting specific files. Specific file modifications may be a required step for many techniques, such as establishing Persistence via [Accessibility Features](https://attack.mitre.org/techniques/T1015), [Logon Scripts](https://attack.mitre.org/techniques/T1037), or tainting/hijacking other instrumental binary/configuration files."}, {"Id": "t1501", "Name": "Systemd Service", "Detected": ".service", "Description": "Systemd services can be used to establish persistence on a Linux system. The systemd service manager is commonly used for managing background daemon processes (also known as services) and other system resources.(Citation: Linux man-pages: systemd January 2014)(Citation: Freedesktop.org Linux systemd 29SEP2018) Systemd is the default initialization (init) system on many Linux distributions starting with Debian 8, Ubuntu 15.04, CentOS 7, RHEL 7, Fedora 15, and replaces legacy init systems including SysVinit and Upstart while remaining backwards compatible with the aforementioned init systems.\n\nSystemd utilizes configuration files known as service units to control how services boot and under what conditions. By default, these unit files are stored in the <code>/etc/systemd/system</code> and <code>/usr/lib/systemd/system</code> directories and have the file extension <code>.service</code>. Each service unit file may contain numerous directives that can execute system commands. \n\n* ExecStart, ExecStartPre, and ExecStartPost directives cover execution of commands when a services is started manually by 'systemctl' or on system start if the service is set to automatically start. \n* ExecReload directive covers when a service restarts. \n* ExecStop and ExecStopPost directives cover when a service is stopped or manually by 'systemctl'.\n\nAdversaries have used systemd functionality to establish persistent access to victim systems by creating and/or modifying service unit files that cause systemd to execute malicious commands at recurring intervals, such as at system boot.(Citation: Anomali Rocke March 2019)(Citation: gist Arch package compromise 10JUL2018)(Citation: Arch Linux Package Systemd Compromise BleepingComputer 10JUL2018)(Citation: acroread package compromised Arch Linux Mail 8JUL2018)\n\nWhile adversaries typically require root privileges to create/modify service unit files in the <code>/etc/systemd/system</code> and <code>/usr/lib/systemd/system</code> directories, low privilege users can create/modify service unit files in directories such as <code>~/.config/systemd/user/</code> to achieve user-level persistence.(Citation: Rapid7 Service Persistence 22JUNE2016)"}]}, "Yara": {"Matches": [{"Count": "0", "Offset": "0x1c8", "Rule": "Relocations_Section_Detecton_1", "Patteren": ".reloc", "Parsed": "None", "Condition": "uint16(0) == 0x5a4d and uint32be(uint32(0x3c)) == 0x50450000 and (for any of them : ( $ in (0..1024) ))"}, {"Count": "0", "Offset": "0x1a0", "Rule": "Resource_section_Detecton_1", "Patteren": ".rsrc", "Parsed": "None", "Condition": "uint16(0) == 0x5a4d and uint32be(uint32(0x3c)) == 0x50450000 and (for any of them : ( $ in (0..1024) ))"}, {"Count": "0", "Offset": "0x178", "Rule": "Code_Section_Detecton_2", "Patteren": ".text", "Parsed": "None", "Condition": "uint16(0) == 0x5a4d and uint32be(uint32(0x3c)) == 0x50450000 and (for any of them : ( $ in (0..1024) ))"}, {"Count": "0", "Offset": "0x1834", "Rule": "Top1000Passwords", "Patteren": "1\u00002\u00003\u00004\u00005\u00006\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x1834", "Rule": "Top1000Passwords", "Patteren": "1\u00002\u00003\u00004\u00005\u00006\u00007\u00008\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x1834", "Rule": "Top1000Passwords", "Patteren": "1\u00002\u00003\u00004\u00005\u00006\u00007\u00008\u00009\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x1834", "Rule": "Top1000Passwords", "Patteren": "1\u00002\u00003\u00004\u00005\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x1834", "Rule": "Top1000Passwords", "Patteren": "1\u00002\u00003\u00004\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x1834", "Rule": "Top1000Passwords", "Patteren": "1\u00002\u00003\u00004\u00005\u00006\u00007\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "3", "Offset": "0x14a8 0x1516 0x1521 0x209c", "Rule": "Top1000Passwords", "Patteren": "Computer", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x1b0a", "Rule": "Top1000Passwords", "Patteren": "c\u0000o\u0000m\u0000p\u0000u\u0000t\u0000e\u0000r\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x1be7", "Rule": "Top1000Passwords", "Patteren": "f\u0000U\u0000c\u0000k\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x295a", "Rule": "Top1000Passwords", "Patteren": "Access", "Parsed": "None", "Condition": "any of them"}, {"Count": "1", "Offset": "0x255a 0x255c", "Rule": "Top1000Passwords", "Patteren": "0\u00000\u00000\u00000\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x255a", "Rule": "Top1000Passwords", "Patteren": "0\u00000\u00000\u00000\u00000\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "1", "Offset": "0x1465 0x174e", "Rule": "Top1000Passwords", "Patteren": "Star", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x1439", "Rule": "Top1000Passwords", "Patteren": "action", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x11fc", "Rule": "Top1000Passwords", "Patteren": "mark", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x26be", "Rule": "Top1000Passwords", "Patteren": "m\u0000a\u0000r\u0000k\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "1", "Offset": "0x28d4 0x2990", "Rule": "Top1000Passwords", "Patteren": "security", "Parsed": "None", "Condition": "any of them"}, {"Count": "16", "Offset": "0xf57 0x1363 0x1391 0x13b0 0x13ca 0x140a 0x141f 0x1440 0x14f1 0x1541 0x15ba 0x1600 0x1620 0x1f9c 0x2037 0x20fd 0x216a", "Rule": "Top1000Passwords", "Patteren": "System", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x1a8a", "Rule": "Top1000Passwords", "Patteren": "k\u0000i\u0000n\u0000g\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "1", "Offset": "0x102f 0x1042", "Rule": "Top1000Passwords", "Patteren": "WindowS", "Parsed": "None", "Condition": "any of them"}, {"Count": "2", "Offset": "0x184e 0x1898 0x18f2", "Rule": "Top1000Passwords", "Patteren": "W\u0000i\u0000n\u0000d\u0000o\u0000w\u0000s\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x1aa6", "Rule": "Top1000Passwords", "Patteren": "W\u0000i\u0000n\u0000d\u0000o\u0000w\u0000S\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x183a", "Rule": "Top1000Passwords", "Patteren": "4\u00005\u00006\u00007\u00008\u00009\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x231e", "Rule": "Microsoft_NET_Runtime_Execution_Engine_Detection_1", "Patteren": "mscoree.dll", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x0", "Rule": "Windows_DOS_executable_file_EXE", "Patteren": "MZ", "Parsed": "None", "Condition": "$1 at 0"}, {"Count": "0", "Offset": "0x21d7", "Rule": "Path", "Patteren": "\u0000C:\\Users\\Jawhar\\documents\\visual studio 2017\\Projects\\ConsoleApp5\\ConsoleApp5\\obj\\Release\\ConsoleApp5.pdb\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0004A\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u001eA\u0000\u0000\u0000 \u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0010A\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000_CorExeMain\u0000mscoree.dll\u0000\u0000\u0000\u0000\u0000%\u0000 @\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x231d", "Rule": "Path", "Patteren": "\u0000mscoree.dll", "Parsed": "None", "Condition": "any of them"}, {"Count": "0", "Offset": "0x230a", "Rule": "NET_executable_Detecton_1", "Patteren": "\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000_CorExeMain\u0000mscoree.dll\u0000\u0000\u0000\u0000\u0000%", "Parsed": "None", "Condition": "$1"}, {"Count": "0", "Offset": "0x232e", "Rule": "NET_executable_Detecton_2", "Patteren": "%\u0000 @\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000", "Parsed": "None", "Condition": "$1 at pe.entry_point"}, {"Count": "0", "Offset": "0x4e", "Rule": "dUP_v2_x_Patcher_Detecton_1", "Patteren": "This program cannot be run in DOS mo", "Parsed": "None", "Condition": "$1"}, {"Count": "0", "Offset": "0x232e", "Rule": "Microsoft_Visual_C_Basic_NET_Detecton_1", "Patteren": "%\u0000 @\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000", "Parsed": "None", "Condition": "$1 at pe.entry_point"}, {"Count": "0", "Offset": "0x232e", "Rule": "Microsoft_Visual_C_v7_0_Basic_NET_Detecton_1", "Patteren": "%\u0000 @\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000", "Parsed": "None", "Condition": "$1"}, {"Count": "0", "Offset": "0x232e", "Rule": "Microsoft_Visual_Studio_NET_Detecton_1", "Patteren": "%\u0000 @\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000", "Parsed": "None", "Condition": "$1 at pe.entry_point"}], "Tags": [{"fullrule": "packers_index:NETexecutableMicrosoft", "namespace": "packers_index", "color": "brown_color", "rule": "NETexecutableMicrosoft", "meta": "author: malware-lu"}, {"fullrule": "packers_index:IsPE32", "namespace": "packers_index", "color": "brown_color", "rule": "IsPE32", "meta": ""}, {"fullrule": "packers_index:IsNET_EXE", "namespace": "packers_index", "color": "brown_color", "rule": "IsNET_EXE", "meta": ""}, {"fullrule": "packers_index:IsConsole", "namespace": "packers_index", "color": "brown_color", "rule": "IsConsole", "meta": ""}, {"fullrule": "packers_index:HasDebugData", "namespace": "packers_index", "color": "brown_color", "rule": "HasDebugData", "meta": "author: _pusher_\ndescription: DebugData Check\ndate: 2016-07"}, {"fullrule": "packers_index:Microsoft_Visual_Studio_NET", "namespace": "packers_index", "color": "brown_color", "rule": "Microsoft_Visual_Studio_NET", "meta": ""}, {"fullrule": "packers_index:Microsoft_Visual_C_v70_Basic_NET_additional", "namespace": "packers_index", "color": "brown_color", "rule": "Microsoft_Visual_C_v70_Basic_NET_additional", "meta": ""}, {"fullrule": "packers_index:Microsoft_Visual_C_Basic_NET", "namespace": "packers_index", "color": "brown_color", "rule": "Microsoft_Visual_C_Basic_NET", "meta": ""}, {"fullrule": "packers_index:Microsoft_Visual_Studio_NET_additional", "namespace": "packers_index", "color": "brown_color", "rule": "Microsoft_Visual_Studio_NET_additional", "meta": ""}, {"fullrule": "packers_index:Microsoft_Visual_C_v70_Basic_NET", "namespace": "packers_index", "color": "brown_color", "rule": "Microsoft_Visual_C_v70_Basic_NET", "meta": ""}, {"fullrule": "packers_index:NET_executable_", "namespace": "packers_index", "color": "brown_color", "rule": "NET_executable_", "meta": ""}, {"fullrule": "packers_index:NET_executable", "namespace": "packers_index", "color": "brown_color", "rule": "NET_executable", "meta": ""}, {"fullrule": "malware_index:nkminer_monero", "namespace": "malware_index", "color": "red_color", "rule": "nkminer_monero", "meta": "description: Detects installer of Monero miner that points to a NK domain\nauthor: cdoman@alienvault.com\nreference: https://www.alienvault.com/blogs/labs-research/a-north-korean-monero-cryptocurrency-miner\ntlp: white\nlicense: MIT License"}]}, "Codes": {"Codes": ["36", "840"]}}